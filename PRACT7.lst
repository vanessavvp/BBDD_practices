SQL> SPOOL
currently spooling to PRACT7.lst
SQL> /* PRACTICA 7 - CONTROL DE TRANSACCIONES
SQL> APRENDER A GESTIONAR TRANSACCIONES: ESTABLECER PUNTOS DE CONTROL, HACER PERMANENTES LOS CAMBIOS,
SQL> DESHACER TOTALMENTE, DESHACER PARCIALMENTE... DETERMINAR CAUSAS FRECUENTES DE FALLO EN LAS
SQL> TRANSACCIONES
SQL> 
SQL> ASIGNATURA - BASES DE DATOS
SQL> AUTORA - VANESSA VALENTINA VILLALBA PEREZ
SQL> UNIVERSIDAD DE LA LAGUNA: */
SQL> -- APARTADO 1:
SQL> SELECT *
  2  FROM PROFESOR;

       DNI P                                                                    
---------- ------------------------------------------------------------         
       CAR CAT                                                                  
---------- -----                                                                
      1111 JUAN                                                                 
         6 CU                                                                   
                                                                                
      2222 CARLOS                                                               
         7 TU                                                                   
                                                                                
      3333 PEDRO                                                                
         4 TEU                                                                  
                                                                                

       DNI P                                                                    
---------- ------------------------------------------------------------         
       CAR CAT                                                                  
---------- -----                                                                
      4444 MARIA                                                                
         7 TU                                                                   
                                                                                
      5555 IVAN                                                                 
         1 CEU                                                                  
                                                                                
      6666 CARMEN                                                               
         3 CD                                                                   
                                                                                

       DNI P                                                                    
---------- ------------------------------------------------------------         
       CAR CAT                                                                  
---------- -----                                                                
      7777 MARIO                                                                
         2 TU                                                                   
                                                                                
      8888 FRANCISCO                                                            
         5 TU                                                                   
                                                                                
      9999 ANGELA                                                               
         8 TEU                                                                  
                                                                                

       DNI P                                                                    
---------- ------------------------------------------------------------         
       CAR CAT                                                                  
---------- -----                                                                
      1010 DAVID                                                                
         4 TU                                                                   
                                                                                
      2020 SOLEDAD                                                              
         7 CU                                                                   
                                                                                
      3030 JOSE MANUEL                                                          
         6 TEU                                                                  
                                                                                

12 rows selected.

SQL> SET LINESIZE 380
SQL> SET PAGESIZE 380
SQL> RUN
  1  SELECT *
  2* FROM PROFESOR

       DNI P                                                                   CAR CAT                                                                                                                                                                                                                                                                                                      
---------- ------------------------------------------------------------ ---------- -----                                                                                                                                                                                                                                                                                                    
      1111 JUAN                                                                  6 CU                                                                                                                                                                                                                                                                                                       
      2222 CARLOS                                                                7 TU                                                                                                                                                                                                                                                                                                       
      3333 PEDRO                                                                 4 TEU                                                                                                                                                                                                                                                                                                      
      4444 MARIA                                                                 7 TU                                                                                                                                                                                                                                                                                                       
      5555 IVAN                                                                  1 CEU                                                                                                                                                                                                                                                                                                      
      6666 CARMEN                                                                3 CD                                                                                                                                                                                                                                                                                                       
      7777 MARIO                                                                 2 TU                                                                                                                                                                                                                                                                                                       
      8888 FRANCISCO                                                             5 TU                                                                                                                                                                                                                                                                                                       
      9999 ANGELA                                                                8 TEU                                                                                                                                                                                                                                                                                                      
      1010 DAVID                                                                 4 TU                                                                                                                                                                                                                                                                                                       
      2020 SOLEDAD                                                               7 CU                                                                                                                                                                                                                                                                                                       
      3030 JOSE MANUEL                                                           6 TEU                                                                                                                                                                                                                                                                                                      

12 rows selected.

SQL> -- APARTADO 2:
SQL> INSERT INTO PROFESOR
  2  VALUES(4040, 'CARMELO', 7, 'TU');

1 row created.

SQL> -- APARTADO 3:
SQL> SELECT *
  2  FROM PROFESOR;

       DNI P                                                                   CAR CAT                                                                                                                                                                                                                                                                                                      
---------- ------------------------------------------------------------ ---------- -----                                                                                                                                                                                                                                                                                                    
      1111 JUAN                                                                  6 CU                                                                                                                                                                                                                                                                                                       
      2222 CARLOS                                                                7 TU                                                                                                                                                                                                                                                                                                       
      3333 PEDRO                                                                 4 TEU                                                                                                                                                                                                                                                                                                      
      4444 MARIA                                                                 7 TU                                                                                                                                                                                                                                                                                                       
      5555 IVAN                                                                  1 CEU                                                                                                                                                                                                                                                                                                      
      6666 CARMEN                                                                3 CD                                                                                                                                                                                                                                                                                                       
      7777 MARIO                                                                 2 TU                                                                                                                                                                                                                                                                                                       
      8888 FRANCISCO                                                             5 TU                                                                                                                                                                                                                                                                                                       
      9999 ANGELA                                                                8 TEU                                                                                                                                                                                                                                                                                                      
      1010 DAVID                                                                 4 TU                                                                                                                                                                                                                                                                                                       
      2020 SOLEDAD                                                               7 CU                                                                                                                                                                                                                                                                                                       
      3030 JOSE MANUEL                                                           6 TEU                                                                                                                                                                                                                                                                                                      
      4040 CARMELO                                                               7 TU                                                                                                                                                                                                                                                                                                       

13 rows selected.

SQL> -- APARTADO 4:
SQL> ROLLBACK;

Rollback complete.

SQL> -- APARTADO 5:
SQL> SELECT *
  2  FROM PROFESOR;

       DNI P                                                                   CAR CAT                                                                                                                                                                                                                                                                                                      
---------- ------------------------------------------------------------ ---------- -----                                                                                                                                                                                                                                                                                                    
      1111 JUAN                                                                  6 CU                                                                                                                                                                                                                                                                                                       
      2222 CARLOS                                                                7 TU                                                                                                                                                                                                                                                                                                       
      3333 PEDRO                                                                 4 TEU                                                                                                                                                                                                                                                                                                      
      4444 MARIA                                                                 7 TU                                                                                                                                                                                                                                                                                                       
      5555 IVAN                                                                  1 CEU                                                                                                                                                                                                                                                                                                      
      6666 CARMEN                                                                3 CD                                                                                                                                                                                                                                                                                                       
      7777 MARIO                                                                 2 TU                                                                                                                                                                                                                                                                                                       
      8888 FRANCISCO                                                             5 TU                                                                                                                                                                                                                                                                                                       
      9999 ANGELA                                                                8 TEU                                                                                                                                                                                                                                                                                                      
      1010 DAVID                                                                 4 TU                                                                                                                                                                                                                                                                                                       
      2020 SOLEDAD                                                               7 CU                                                                                                                                                                                                                                                                                                       
      3030 JOSE MANUEL                                                           6 TEU                                                                                                                                                                                                                                                                                                      

12 rows selected.

SQL> -- APARTADO 6:
SQL> INSERT INTO PROFESOR
  2  VALUES(4040, 'CARMELO', 7, 'TU');

1 row created.

SQL> -- APARTADO 7:
SQL> COMMIT;

Commit complete.

SQL> -- APARTADO 8:
SQL> INSERT INTO PROFESOR
  2  VALUES(5050, 'CARINA', 9, 'CEU');
INSERT INTO PROFESOR
*
ERROR at line 1:
ORA-02291: integrity constraint (ALU0101265704.SYS_C00214640) violated - parent key not found 


SQL> /* HA FALLADO DEBIDO A QUE EL CODIGO DE AREA(CAR)=9 NO EXISTE EN LA TABLA AREA Y COMO LA TABLA PROFESOR
SQL> TIENE COMO CLAVE AJENA DICHO ATRIBUTO OBTENEMOS EL MENSAJE 'PARENT KEY NOT FOUND': */
SQL> -- APARTADO 9:
SQL> INSERT INTO PROFESOR
  2  VALUES(5050, 'CARINA', 8, 'CEU');

1 row created.

SQL> -- APARTADO 10:
SQL> SELECT *
  2  FROM PROFESOR;

       DNI P                                                                   CAR CAT                                                                                                                                                                                                                                                                                                      
---------- ------------------------------------------------------------ ---------- -----                                                                                                                                                                                                                                                                                                    
      1111 JUAN                                                                  6 CU                                                                                                                                                                                                                                                                                                       
      2222 CARLOS                                                                7 TU                                                                                                                                                                                                                                                                                                       
      3333 PEDRO                                                                 4 TEU                                                                                                                                                                                                                                                                                                      
      4444 MARIA                                                                 7 TU                                                                                                                                                                                                                                                                                                       
      5555 IVAN                                                                  1 CEU                                                                                                                                                                                                                                                                                                      
      6666 CARMEN                                                                3 CD                                                                                                                                                                                                                                                                                                       
      7777 MARIO                                                                 2 TU                                                                                                                                                                                                                                                                                                       
      8888 FRANCISCO                                                             5 TU                                                                                                                                                                                                                                                                                                       
      9999 ANGELA                                                                8 TEU                                                                                                                                                                                                                                                                                                      
      1010 DAVID                                                                 4 TU                                                                                                                                                                                                                                                                                                       
      2020 SOLEDAD                                                               7 CU                                                                                                                                                                                                                                                                                                       
      3030 JOSE MANUEL                                                           6 TEU                                                                                                                                                                                                                                                                                                      
      4040 CARMELO                                                               7 TU                                                                                                                                                                                                                                                                                                       
      5050 CARINA                                                                8 CEU                                                                                                                                                                                                                                                                                                      

14 rows selected.

SQL> -- APARTADO 14:
SQL> COMMIT;

Commit complete.

SQL> -- APARTADO 17:
SQL> DELETE FROM PLAN_DOCENTE
  2  WHERE DNI=4444;

3 rows deleted.

SQL> -- APARTADO 18:
SQL> SELECT *
  2  FROM PLAN_DOCENTE
  3  WHERE DNI=4444;

no rows selected

SQL> -- APARTADO 19:
SQL> SAVEPOINT P1;

Savepoint created.

SQL> -- APARTADO 20:
SQL> DELETE FROM PLAN_DOCENTE
  2  WHERE DNI=1010;

3 rows deleted.

SQL> -- APARTADO 21:
SQL> SAVEPOINT P2;

Savepoint created.

SQL> -- APARTADO 22:
SQL> DELENTE FROM PLAN_DOCENTE
SP2-0734: unknown command beginning "DELENTE FR..." - rest of line ignored.
SQL> DELETE FROM PLAN_DOCENTE
  2  WHERE DNI=2222;

2 rows deleted.

SQL> -- APARTADO 23:
SQL> SELECT *
  2  FROM PLAN_DOCENTE;

       DNI        CAS        CTA        CPA        CLA FI        FF                                                                                                                                                                                                                                                                                                                         
---------- ---------- ---------- ---------- ---------- --------- ---------                                                                                                                                                                                                                                                                                                                  
      1111          8          3        1.5        1.5 01-SEP-07 31-AUG-09                                                                                                                                                                                                                                                                                                                  
      1111          8          3          0          0 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      3030          8          0        1.5        1.5 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      3333          2        1.5        1.5          3 01-SEP-08                                                                                                                                                                                                                                                                                                                            
      9999          7          3          3          0 01-SEP-10                                                                                                                                                                                                                                                                                                                            
      5555          6          3          3          0 31-MAR-10                                                                                                                                                                                                                                                                                                                            
      6666         10          3        1.5        1.5 01-SEP-08 31-AUG-11                                                                                                                                                                                                                                                                                                                  
      8888         11          6          0          0 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      2020          3        1.5          0        1.5 01-SEP-08                                                                                                                                                                                                                                                                                                                            
      7777         12        4.5          3          0 01-SEP-10                                                                                                                                                                                                                                                                                                                            
      3333          9        1.5          0        1.5 01-SEP-09                                                                                                                                                                                                                                                                                                                            

11 rows selected.

SQL> -- APARTADO 24:
SQL> INSERT INTO PLAN_DOCENTE
  2  VALUES(1010, 9, 1.5, 0, 1.5, '01-SEP-09', NULL);

1 row created.

SQL> -- APARTADO 25:
SQL> SELECT *
  2  FROM PLAN_DOCENTE;

       DNI        CAS        CTA        CPA        CLA FI        FF                                                                                                                                                                                                                                                                                                                         
---------- ---------- ---------- ---------- ---------- --------- ---------                                                                                                                                                                                                                                                                                                                  
      1010          9        1.5          0        1.5 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      1111          8          3        1.5        1.5 01-SEP-07 31-AUG-09                                                                                                                                                                                                                                                                                                                  
      1111          8          3          0          0 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      3030          8          0        1.5        1.5 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      3333          2        1.5        1.5          3 01-SEP-08                                                                                                                                                                                                                                                                                                                            
      9999          7          3          3          0 01-SEP-10                                                                                                                                                                                                                                                                                                                            
      5555          6          3          3          0 31-MAR-10                                                                                                                                                                                                                                                                                                                            
      6666         10          3        1.5        1.5 01-SEP-08 31-AUG-11                                                                                                                                                                                                                                                                                                                  
      8888         11          6          0          0 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      2020          3        1.5          0        1.5 01-SEP-08                                                                                                                                                                                                                                                                                                                            
      7777         12        4.5          3          0 01-SEP-10                                                                                                                                                                                                                                                                                                                            
      3333          9        1.5          0        1.5 01-SEP-09                                                                                                                                                                                                                                                                                                                            

12 rows selected.

SQL> -- APARTADO 26:
SQL> ROLLBACK TO P2;

Rollback complete.

SQL> -- APARTADO 27:
SQL> SELECT *
  2  FROM PLAN_DOCENTE;

       DNI        CAS        CTA        CPA        CLA FI        FF                                                                                                                                                                                                                                                                                                                         
---------- ---------- ---------- ---------- ---------- --------- ---------                                                                                                                                                                                                                                                                                                                  
      1111          8          3        1.5        1.5 01-SEP-07 31-AUG-09                                                                                                                                                                                                                                                                                                                  
      1111          8          3          0          0 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      3030          8          0        1.5        1.5 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      2222          4        1.5          0        1.5 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      2222          3        1.5          0        1.5 01-SEP-06 31-AUG-07                                                                                                                                                                                                                                                                                                                  
      3333          2        1.5        1.5          3 01-SEP-08                                                                                                                                                                                                                                                                                                                            
      9999          7          3          3          0 01-SEP-10                                                                                                                                                                                                                                                                                                                            
      5555          6          3          3          0 31-MAR-10                                                                                                                                                                                                                                                                                                                            
      6666         10          3        1.5        1.5 01-SEP-08 31-AUG-11                                                                                                                                                                                                                                                                                                                  
      8888         11          6          0          0 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      2020          3        1.5          0        1.5 01-SEP-08                                                                                                                                                                                                                                                                                                                            
      7777         12        4.5          3          0 01-SEP-10                                                                                                                                                                                                                                                                                                                            
      3333          9        1.5          0        1.5 01-SEP-09                                                                                                                                                                                                                                                                                                                            

13 rows selected.

SQL> -- APARTADO 28:
SQL> ROLLBACK TO P1;

Rollback complete.

SQL> -- APARTADO 29:
SQL> SELECT *
  2  FROM PLAN_DOCENTE;

       DNI        CAS        CTA        CPA        CLA FI        FF                                                                                                                                                                                                                                                                                                                         
---------- ---------- ---------- ---------- ---------- --------- ---------                                                                                                                                                                                                                                                                                                                  
      1111          8          3        1.5        1.5 01-SEP-07 31-AUG-09                                                                                                                                                                                                                                                                                                                  
      1111          8          3          0          0 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      3030          8          0        1.5        1.5 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      2222          4        1.5          0        1.5 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      2222          3        1.5          0        1.5 01-SEP-06 31-AUG-07                                                                                                                                                                                                                                                                                                                  
      1010          2        1.5        1.5          3 01-SEP-05 31-AUG-08                                                                                                                                                                                                                                                                                                                  
      3333          2        1.5        1.5          3 01-SEP-08                                                                                                                                                                                                                                                                                                                            
      1010          9          3          0          3 01-SEP-08 31-AUG-09                                                                                                                                                                                                                                                                                                                  
      1010          9        1.5          0        1.5 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      9999          7          3          3          0 01-SEP-10                                                                                                                                                                                                                                                                                                                            
      5555          6          3          3          0 31-MAR-10                                                                                                                                                                                                                                                                                                                            
      6666         10          3        1.5        1.5 01-SEP-08 31-AUG-11                                                                                                                                                                                                                                                                                                                  
      8888         11          6          0          0 01-SEP-09                                                                                                                                                                                                                                                                                                                            
      2020          3        1.5          0        1.5 01-SEP-08                                                                                                                                                                                                                                                                                                                            
      7777         12        4.5          3          0 01-SEP-10                                                                                                                                                                                                                                                                                                                            
      3333          9        1.5          0        1.5 01-SEP-09                                                                                                                                                                                                                                                                                                                            

16 rows selected.

SQL> -- APARTADO 39:
SQL> -- CORRECCION, APARTADO 30* :
SQL> SPOOL
currently spooling to PRACT7.lst
SQL> SPOOL OFF
